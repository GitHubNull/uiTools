# 交互功能实现

<cite>
**Referenced Files in This Document **   
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java)
</cite>

## 目录
1. [自动换行功能](#自动换行功能)
2. [快捷键支持](#快捷键支持)
3. [剪贴板操作](#剪贴板操作)
4. [内容交换功能](#内容交换功能)
5. [交互功能整合](#交互功能整合)

## 自动换行功能

在uiTools应用中，`wrapCheckBox`复选框通过事件监听器统一控制三个文本区域的自动换行行为。当用户勾选或取消勾选该复选框时，会触发相应的事件监听器，同时更新输入、输出和表达式三个文本区域的自动换行设置。

`wrapCheckBox`组件通过`addActionListener`方法注册事件监听器，当复选框状态改变时，监听器会获取当前选中状态，并将该状态应用到所有相关的文本区域。具体实现中，通过调用`setLineWrap(boolean wrap)`方法来控制文本是否在到达边界时自动换行，同时调用`setWrapStyleWord(boolean wrap)`方法确保在单词边界处进行换行，避免单词被截断。

`setWrapStyleWord`方法的作用是控制文本换行时的断词行为。当设置为`true`时，系统会在单词边界处进行换行，确保完整的单词不会被分割到两行；当设置为`false`时，系统可能在任意字符位置进行换行，可能导致单词被截断。这种设计提升了文本的可读性，特别是在处理长字符串或代码时，用户可以更清晰地查看内容。

**Section sources**
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java#L322-L390)

## 快捷键支持

`setupKeyboardShortcuts`方法为应用程序中的各种操作配置了快捷键，极大地提升了用户的操作效率。该方法通过为按钮设置助记符（mnemonic）和为文本区域配置输入映射（InputMap）和动作映射（ActionMap）来实现快捷键功能。

对于执行、复制、粘贴等操作，方法为相应的按钮设置了对应的快捷键。例如，执行按钮通过`setMnemonic(KeyEvent.VK_E)`配置了Ctrl+E快捷键，复制输入按钮配置了Ctrl+C快捷键，粘贴输入按钮配置了Ctrl+V快捷键。这些快捷键的配置使得用户无需使用鼠标即可快速执行常用操作。

此外，该方法还为输入和输出文本区域配置了全选功能的快捷键Ctrl+A。通过在输入映射中添加`KeyStroke.getKeyStroke(KeyEvent.VK_A, InputEvent.CTRL_DOWN_MASK)`，并将其关联到"selectAll"动作，实现了跨文本区域的一致性快捷键支持。这种设计遵循了用户对标准快捷键的预期，降低了学习成本。

**Section sources**
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java#L456-L489)

## 剪贴板操作

uiTools应用提供了完整的剪贴板操作功能，包括复制、粘贴和清空等操作。这些功能通过为相应的按钮注册事件监听器来实现，确保了与系统剪贴板的无缝交互。

复制功能通过`copyInputButton`和`copyOutputButton`两个按钮实现。当用户点击复制按钮时，事件监听器会获取相应文本区域的内容，创建`StringSelection`对象，并通过系统剪贴板的`setContents`方法将内容写入剪贴板。这一过程使用了Java的`Toolkit.getDefaultToolkit().getSystemClipboard()`来访问系统剪贴板，确保了与操作系统其他应用程序的兼容性。

粘贴功能通过`pasteInputButton`按钮实现，采用了更加健壮的异常处理机制。监听器首先尝试从系统剪贴板获取内容，检查是否存在支持字符串数据格式的传输数据。如果存在，将内容转换为字符串并设置到输入文本区域；如果操作失败，则捕获异常并记录错误日志，同时向用户显示友好的错误信息。这种设计确保了应用程序的稳定性，即使在剪贴板访问出现问题时也不会崩溃。

清空功能通过`clearInputButton`和`clearExpressionButton`按钮实现，分别用于清空输入文本区域和表达式文本区域的内容。这些操作简单直接，通过调用文本区域的`setText("")`方法实现，同时记录相应的日志信息。

**Section sources**
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java#L322-L390)

## 内容交换功能

内容交换功能通过`swapButton`按钮实现，允许用户快速交换输入和输出文本区域的内容。这一功能特别适用于需要对比或反向处理文本的场景，显著提升了用户的工作效率。

交换操作的实现通过事件监听器完成。当用户点击交换按钮时，监听器首先获取输入和输出文本区域的当前内容，然后将输出内容设置到输入区域，同时将输入内容设置到输出区域。这一过程通过简单的变量交换实现，确保了操作的原子性和一致性。

在执行交换操作后，系统会记录相应的日志信息，告知用户交换操作已完成。这种设计不仅提供了视觉反馈，还便于用户追踪操作历史。与其他交互功能一样，交换功能也集成在统一的事件监听器框架中，保持了代码结构的一致性和可维护性。

**Section sources**
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java#L322-L390)

## 交互功能整合

uiTools的交互功能通过`setupEventListeners`方法进行了统一整合，确保了所有用户界面元素的协调工作。该方法集中管理了所有按钮的事件监听器，包括执行、复制、粘贴、清空、交换和自动换行等功能。

这种集中式的事件管理设计具有多个优势：首先，它提高了代码的可读性和可维护性，所有交互逻辑都位于一个明确的位置；其次，它便于功能的扩展和修改，新增或调整交互功能时只需在该方法中进行相应修改；最后，它确保了异常处理的一致性，所有可能出错的操作都采用了相似的异常捕获和处理策略。

所有交互操作都通过调用`log`方法记录日志，为用户提供操作反馈，同时也为问题排查提供了依据。这种设计体现了用户友好的原则，让用户清楚地了解每个操作的结果。通过将这些交互功能有机整合，uiTools为用户提供了一个高效、直观且可靠的使用体验。

**Section sources**
- [StringFormatterUI.java](file://src\main\java\org\oxff\ui\StringFormatterUI.java#L322-L390)